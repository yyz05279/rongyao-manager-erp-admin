# 测试指南 - 子系统模板基础信息修改功能

## 测试目标

验证子系统模板基础信息修改功能是否正常工作，确保：
1. 基础信息可以正确更新
2. 不会重复添加子项
3. 错误处理正确
4. 用户体验良好

## 测试环境准备

### 1. 启动项目
```bash
cd /Users/yyz/Desktop/haitang-web-admin
npm run dev
```

### 2. 登录系统
- 访问：http://localhost:5173
- 使用管理员账号登录

### 3. 进入测试页面
- 导航至：ERP管理 -> 子系统管理 -> 子系统模板

## 测试用例

### 测试用例 1：新增模板（基础功能验证）

**测试步骤：**
1. 点击"新增"按钮
2. 填写表单信息：
   - 模板名称：测试模板001
   - 分类：电气系统
   - 版本号：v1.0
   - 状态：草稿
   - 描述：这是一个测试模板
   - 备注：用于测试基础信息修改功能
3. 点击"确定"按钮

**预期结果：**
- ✅ 提示"新增成功"
- ✅ 模板列表刷新，显示新增的模板
- ✅ 模板编号自动生成（格式：TPL-SS-yyyyMMdd-序号）

---

### 测试用例 2：编辑基础信息（核心功能）

**测试步骤：**
1. 在模板列表中找到刚创建的"测试模板001"
2. 点击"编辑"按钮
3. 修改以下信息：
   - 模板名称：测试模板001（已修改）
   - 描述：更新后的描述信息
   - 备注：添加新的备注内容
   - 状态：启用
4. 点击"确定"按钮

**预期结果：**
- ✅ 提示"修改成功"
- ✅ 模板列表刷新，显示更新后的信息
- ✅ 模板名称、描述、备注、状态都已更新
- ✅ 模板编号保持不变

**关键验证点：**
- ❗ 如果模板已有子项，子项列表不应该被重复添加
- ❗ 子项数量保持不变

---

### 测试用例 3：多次编辑基础信息

**测试目的：** 验证多次编辑不会导致数据重复

**测试步骤：**
1. 对同一个模板进行第二次编辑
2. 只修改备注信息：添加第二次修改的备注
3. 点击"确定"按钮
4. 再次编辑，修改描述信息
5. 点击"确定"按钮

**预期结果：**
- ✅ 每次修改都能成功
- ✅ 只有修改的字段被更新
- ✅ 其他字段保持不变
- ✅ 不会出现数据重复或异常

---

### 测试用例 4：表单验证

**测试步骤：**
1. 点击"编辑"按钮
2. 清空"模板名称"字段
3. 点击"确定"按钮

**预期结果：**
- ✅ 显示验证提示："请输入模板名称"
- ✅ 表单不会提交
- ✅ 焦点定位到错误字段

---

### 测试用例 5：取消编辑

**测试步骤：**
1. 点击"编辑"按钮
2. 修改一些信息
3. 点击"取消"按钮

**预期结果：**
- ✅ 对话框关闭
- ✅ 数据没有被保存
- ✅ 列表数据保持原样

---

### 测试用例 6：状态切换

**测试步骤：**
1. 编辑一个草稿状态的模板
2. 将状态改为"启用"
3. 保存
4. 再次编辑，将状态改为"停用"
5. 保存

**预期结果：**
- ✅ 状态切换成功
- ✅ 列表中的状态标签正确显示
- ✅ 不影响其他字段

---

## 错误场景测试

### 错误场景 1：网络异常

**测试步骤：**
1. 打开浏览器开发者工具
2. 切换到 Network 标签
3. 设置网络为 Offline
4. 尝试编辑并保存模板

**预期结果：**
- ✅ 显示错误提示
- ✅ 表单保持打开状态
- ✅ 用户可以重新尝试

---

### 错误场景 2：后端返回错误

**测试步骤：**
1. 尝试修改模板名称为已存在的名称（如果后端有唯一性校验）
2. 点击保存

**预期结果：**
- ✅ 显示后端返回的错误信息
- ✅ 表单保持打开状态
- ✅ 用户可以修正后重新提交

---

## API 调用验证

### 验证方法
打开浏览器开发者工具，切换到 Network 标签，观察 API 调用情况。

### 新增模板时
- **请求：** POST /erp/subsystem/template
- **请求体：** 包含所有基础信息字段
- **响应：** 200 OK，返回新创建的模板ID

### 编辑基础信息时
- **请求：** PUT /erp/subsystem/template
- **请求体：** 包含 id 和要更新的基础信息字段
- **请求体验证：** 不应包含 items 字段
- **响应：** 200 OK，返回成功消息

---

## 测试检查清单

- [ ] 新增模板功能正常
- [ ] 编辑基础信息功能正常
- [ ] 多次编辑不会重复数据
- [ ] 表单验证正确
- [ ] 取消操作正常
- [ ] 状态切换正常
- [ ] 错误提示清晰明确
- [ ] API 调用正确（不包含 items 字段）
- [ ] 子项列表不受影响
- [ ] 用户体验良好

---

## 问题记录

如果在测试过程中发现问题，请记录以下信息：

1. **问题描述：** 
2. **复现步骤：** 
3. **预期结果：** 
4. **实际结果：** 
5. **截图或日志：** 
6. **浏览器版本：** 
7. **测试时间：** 

---

## 测试完成标准

- ✅ 所有测试用例通过
- ✅ 所有检查清单项目完成
- ✅ 没有发现严重问题
- ✅ API 调用符合规范
- ✅ 用户体验符合预期

