# 子系统管理模块 - 菜单权限配置图解

## 菜单结构示意图

子系统管理作为独立的一级菜单，菜单结构应该如下配置：

```
系统菜单
├── 首页
├── 系统管理
├── 化盐工艺流程
└── 子系统管理 ⬅️ 新增的一级菜单
      ├── 子系统列表
      ├── 子系统模板
      └── 子项模板管理 ⬅️ 新增（包含物料管理）
```

## 系统菜单管理配置

### 第一步：创建子系统管理一级菜单

在系统管理 → 菜单管理中，新增一级菜单，配置如下：

| 配置项       | 配置值     | 说明                          |
| ------------ | ---------- | ----------------------------- |
| **上级菜单** | 顶级菜单   | 选择"顶级菜单"（parent_id=0） |
| **菜单类型** | 目录 (M)   | 表示这是一个一级目录          |
| **菜单图标** | component  | 建议使用 component 图标       |
| **菜单名称** | 子系统管理 | 显示在侧边栏的名称            |
| **显示排序** | 3          | 根据需要调整显示顺序          |
| **路由地址** | subsystem  | URL 路径前缀                  |
| **组件路径** | 无需填写   | 一级目录不需要组件路径        |
| **权限字符** | 无需填写   | 一级目录不需要权限字符        |
| **菜单状态** | 正常       | 启用该菜单                    |
| **显示状态** | 显示       | 在侧边栏显示                  |

### 第二步：创建子系统列表子菜单

在刚创建的"子系统管理"菜单下，新增子菜单，配置如下：

| 配置项       | 配置值              | 说明                                     |
| ------------ | ------------------- | ---------------------------------------- |
| **上级菜单** | 子系统管理          | 选择刚创建的"子系统管理"一级菜单         |
| **菜单类型** | 菜单 (C)            | 表示这是一个页面菜单                     |
| **菜单图标** | list                | 建议使用 list 图标                       |
| **菜单名称** | 子系统列表          | 显示在侧边栏的名称                       |
| **显示排序** | 1                   | 第一个子菜单                             |
| **路由地址** | subsystem           | URL 路径，完整路径为 `/subsystem`        |
| **组件路径** | erp/subsystem/index | 对应 `src/views/erp/subsystem/index.vue` |
| **权限字符** | erp:subsystem:list  | 用于控制菜单显示权限                     |
| **菜单状态** | 正常                | 启用该菜单                               |
| **显示状态** | 显示                | 在侧边栏显示                             |
| **是否缓存** | 缓存                | 建议缓存以提升性能                       |

### 第三步：创建子系统模板子菜单

在"子系统管理"菜单下，继续新增"子系统模板"子菜单，配置如下：

| 配置项       | 配置值                       | 说明                                              |
| ------------ | ---------------------------- | ------------------------------------------------- |
| **上级菜单** | 子系统管理                   | 选择"子系统管理"一级菜单                          |
| **菜单类型** | 菜单 (C)                     | 表示这是一个页面菜单                              |
| **菜单图标** | document-copy                | 建议使用 document-copy 图标                       |
| **菜单名称** | 子系统模板                   | 显示在侧边栏的名称                                |
| **显示排序** | 2                            | 第二个子菜单                                      |
| **路由地址** | template                     | URL 路径，完整路径为 `/subsystem/template`        |
| **组件路径** | erp/subsystem/template/index | 对应 `src/views/erp/subsystem/template/index.vue` |
| **权限字符** | erp:subsystem:template:list  | 用于控制菜单显示权限                              |
| **菜单状态** | 正常                         | 启用该菜单                                        |
| **显示状态** | 显示                         | 在侧边栏显示                                      |
| **是否缓存** | 缓存                         | 建议缓存以提升性能                                |

### 第四步：创建子项模板管理子菜单

在"子系统管理"菜单下，继续新增"子项模板管理"子菜单，配置如下：

| 配置项       | 配置值                            | 说明                                                   |
| ------------ | --------------------------------- | ------------------------------------------------------ |
| **上级菜单** | 子系统管理                        | 选择"子系统管理"一级菜单                               |
| **菜单类型** | 菜单 (C)                          | 表示这是一个页面菜单                                   |
| **菜单图标** | menu                              | 建议使用 menu 图标                                     |
| **菜单名称** | 子项模板管理                      | 显示在侧边栏的名称                                     |
| **显示排序** | 3                                 | 第三个子菜单                                           |
| **路由地址** | item-template                     | URL 路径，完整路径为 `/subsystem/item-template`        |
| **组件路径** | erp/subsystem/item-template/index | 对应 `src/views/erp/subsystem/item-template/index.vue` |
| **权限字符** | erp:subsystem:item-template:list  | 用于控制菜单显示权限                                   |
| **菜单状态** | 正常                              | 启用该菜单                                             |
| **显示状态** | 显示                              | 在侧边栏显示                                           |
| **是否缓存** | 缓存                              | 建议缓存以提升性能                                     |

**重要说明**：

- 物料模板是附属于子项的，不需要独立的菜单页面
- 物料管理功能在子项详情或编辑页面中进行
- 物料相关权限配置在子项模板管理的按钮权限中

### 第五步：创建子系统管理按钮权限

#### 4.1 子系统列表按钮权限

在"子系统列表"菜单下，继续添加按钮权限：

##### 4.1.1 子系统操作权限

| 按钮名称   | 权限字符               | 显示排序 |
| ---------- | ---------------------- | -------- |
| 子系统查询 | `erp:subsystem:query`  | 1        |
| 子系统新增 | `erp:subsystem:add`    | 2        |
| 子系统修改 | `erp:subsystem:edit`   | 3        |
| 子系统删除 | `erp:subsystem:remove` | 4        |
| 子系统导出 | `erp:subsystem:export` | 5        |

**配置说明：**

- **上级菜单**：选择"子系统列表"
- **菜单类型**：按钮 (F)
- **显示状态**：显示
- **菜单状态**：正常

##### 4.1.2 子项操作权限

| 按钮名称 | 权限字符                       | 显示排序 |
| -------- | ------------------------------ | -------- |
| 子项查询 | `erp:subsystem:subitem:query`  | 11       |
| 子项新增 | `erp:subsystem:subitem:add`    | 12       |
| 子项修改 | `erp:subsystem:subitem:edit`   | 13       |
| 子项删除 | `erp:subsystem:subitem:remove` | 14       |

##### 4.1.3 物料操作权限

| 按钮名称 | 权限字符                        | 显示排序 |
| -------- | ------------------------------- | -------- |
| 物料查询 | `erp:subsystem:material:query`  | 21       |
| 物料新增 | `erp:subsystem:material:add`    | 22       |
| 物料修改 | `erp:subsystem:material:edit`   | 23       |
| 物料删除 | `erp:subsystem:material:remove` | 24       |
| 物料导出 | `erp:subsystem:material:export` | 25       |

#### 4.2 子系统模板按钮权限

在"子系统模板"菜单下，添加按钮权限：

##### 4.2.1 模板操作权限

| 按钮名称 | 权限字符                        | 显示排序 |
| -------- | ------------------------------- | -------- |
| 模板查询 | `erp:subsystem:template:query`  | 1        |
| 模板新增 | `erp:subsystem:template:add`    | 2        |
| 模板修改 | `erp:subsystem:template:edit`   | 3        |
| 模板删除 | `erp:subsystem:template:remove` | 4        |
| 模板导出 | `erp:subsystem:template:export` | 5        |

**配置说明：**

- **上级菜单**：选择"子系统模板"
- **菜单类型**：按钮 (F)
- **显示状态**：显示
- **菜单状态**：正常

##### 4.2.2 模板子项操作权限

| 按钮名称 | 权限字符                       | 显示排序 |
| -------- | ------------------------------ | -------- |
| 子项查询 | `erp:subsystem:subitem:query`  | 11       |
| 子项新增 | `erp:subsystem:subitem:add`    | 12       |
| 子项修改 | `erp:subsystem:subitem:edit`   | 13       |
| 子项删除 | `erp:subsystem:subitem:remove` | 14       |

**说明**：模板的子项和物料操作复用子系统的权限配置。

##### 4.2.3 模板物料操作权限

| 按钮名称 | 权限字符                        | 显示排序 |
| -------- | ------------------------------- | -------- |
| 物料查询 | `erp:subsystem:material:query`  | 21       |
| 物料新增 | `erp:subsystem:material:add`    | 22       |
| 物料修改 | `erp:subsystem:material:edit`   | 23       |
| 物料删除 | `erp:subsystem:material:remove` | 24       |
| 物料导出 | `erp:subsystem:material:export` | 25       |

#### 4.3 子项模板管理按钮权限

在"子项模板管理"菜单下，添加按钮权限：

##### 4.3.1 子项操作权限

| 按钮名称 | 权限字符                        | 显示排序 |
| -------- | ------------------------------- | -------- |
| 子项查询 | `erp:subsystem:template:query`  | 1        |
| 子项新增 | `erp:subsystem:template:add`    | 2        |
| 子项修改 | `erp:subsystem:template:edit`   | 3        |
| 子项删除 | `erp:subsystem:template:remove` | 4        |
| 子项导出 | `erp:subsystem:template:export` | 5        |

**配置说明：**

- **上级菜单**：选择"子项模板管理"
- **菜单类型**：按钮 (F)
- **显示状态**：显示
- **菜单状态**：正常

**说明**：子项模板管理复用子系统模板的权限配置。

##### 4.3.2 物料操作权限（附属于子项）

| 按钮名称 | 权限字符                                 | 显示排序 |
| -------- | ---------------------------------------- | -------- |
| 物料查询 | `erp:subsystem:template:material:query`  | 11       |
| 物料新增 | `erp:subsystem:template:material:add`    | 12       |
| 物料修改 | `erp:subsystem:template:material:edit`   | 13       |
| 物料删除 | `erp:subsystem:template:material:remove` | 14       |
| 物料导出 | `erp:subsystem:template:material:export` | 15       |

**配置说明：**

- **上级菜单**：选择"子项模板管理"
- **菜单类型**：按钮 (F)
- **显示状态**：显示
- **菜单状态**：正常

**说明**：物料是附属于子项的，在子项的详情或编辑页面中进行管理。物料模板不需要独立的菜单页面。

## 预期菜单结构效果

配置完成后，在系统菜单管理中应该看到如下树形结构：

```
📁 子系统管理（一级目录）
  ├─ 📄 子系统列表 (erp:subsystem:list)
  │    ├─ 🔘 子系统查询 (erp:subsystem:query)
  │    ├─ 🔘 子系统新增 (erp:subsystem:add)
  │    ├─ 🔘 子系统修改 (erp:subsystem:edit)
  │    ├─ 🔘 子系统删除 (erp:subsystem:remove)
  │    ├─ 🔘 子系统导出 (erp:subsystem:export)
  │    ├─ 🔘 子项查询 (erp:subsystem:subitem:query)
  │    ├─ 🔘 子项新增 (erp:subsystem:subitem:add)
  │    ├─ 🔘 子项修改 (erp:subsystem:subitem:edit)
  │    ├─ 🔘 子项删除 (erp:subsystem:subitem:remove)
  │    ├─ 🔘 物料查询 (erp:subsystem:material:query)
  │    ├─ 🔘 物料新增 (erp:subsystem:material:add)
  │    ├─ 🔘 物料修改 (erp:subsystem:material:edit)
  │    ├─ 🔘 物料删除 (erp:subsystem:material:remove)
  │    └─ 🔘 物料导出 (erp:subsystem:material:export)
  ├─ 📄 子系统模板 (erp:subsystem:template:list)
  │    ├─ 🔘 模板查询 (erp:subsystem:template:query)
  │    ├─ 🔘 模板新增 (erp:subsystem:template:add)
  │    ├─ 🔘 模板修改 (erp:subsystem:template:edit)
  │    ├─ 🔘 模板删除 (erp:subsystem:template:remove)
  │    ├─ 🔘 模板导出 (erp:subsystem:template:export)
  │    ├─ 🔘 子项查询 (erp:subsystem:subitem:query)
  │    ├─ 🔘 子项新增 (erp:subsystem:subitem:add)
  │    ├─ 🔘 子项修改 (erp:subsystem:subitem:edit)
  │    ├─ 🔘 子项删除 (erp:subsystem:subitem:remove)
  │    ├─ 🔘 物料查询 (erp:subsystem:material:query)
  │    ├─ 🔘 物料新增 (erp:subsystem:material:add)
  │    ├─ 🔘 物料修改 (erp:subsystem:material:edit)
  │    ├─ 🔘 物料删除 (erp:subsystem:material:remove)
  │    └─ 🔘 物料导出 (erp:subsystem:material:export)
  └─ 📄 子项模板管理 (erp:subsystem:template:list) ⬅️ 新增
       ├─ 🔘 子项查询 (erp:subsystem:template:query)
       ├─ 🔘 子项新增 (erp:subsystem:template:add)
       ├─ 🔘 子项修改 (erp:subsystem:template:edit)
       ├─ 🔘 子项删除 (erp:subsystem:template:remove)
       ├─ 🔘 子项导出 (erp:subsystem:template:export)
       ├─ 🔘 物料查询 (erp:subsystem:template:material:query)
       ├─ 🔘 物料新增 (erp:subsystem:template:material:add)
       ├─ 🔘 物料修改 (erp:subsystem:template:material:edit)
       ├─ 🔘 物料删除 (erp:subsystem:template:material:remove)
       └─ 🔘 物料导出 (erp:subsystem:template:material:export)
```

## 角色权限分配

### 第五步：为角色分配权限

在系统管理 → 角色管理中，编辑相应角色，分配子系统管理权限：

#### 示例：管理员角色（完整权限）

勾选以下权限：

```
☑ 子系统管理（一级目录）
  ☑ 子系统列表
    ☑ 子系统查询
    ☑ 子系统新增
    ☑ 子系统修改
    ☑ 子系统删除
    ☑ 子系统导出
    ☑ 子项查询
    ☑ 子项新增
    ☑ 子项修改
    ☑ 子项删除
    ☑ 物料查询
    ☑ 物料新增
    ☑ 物料修改
    ☑ 物料删除
    ☑ 物料导出
  ☑ 子系统模板
    ☑ 模板查询
    ☑ 模板新增
    ☑ 模板修改
    ☑ 模板删除
    ☑ 模板导出
    ☑ 子项查询
    ☑ 子项新增
    ☑ 子项修改
    ☑ 子项删除
    ☑ 物料查询
    ☑ 物料新增
    ☑ 物料修改
    ☑ 物料删除
    ☑ 物料导出
  ☑ 子项模板管理
    ☑ 子项查询
    ☑ 子项新增
    ☑ 子项修改
    ☑ 子项删除
    ☑ 子项导出
    ☑ 物料查询
    ☑ 物料新增
    ☑ 物料修改
    ☑ 物料删除
    ☑ 物料导出
```

#### 示例：项目经理角色（子系统管理，模板只读）

勾选以下权限：

```
☑ 子系统管理（一级目录）
  ☑ 子系统列表
    ☑ 子系统查询
    ☑ 子系统新增
    ☑ 子系统修改
    ☑ 子系统删除
    ☑ 子项查询
    ☑ 子项新增
    ☑ 子项修改
    ☑ 物料查询
    ☑ 物料新增
    ☑ 物料修改
  ☑ 子系统模板
    ☑ 模板查询
    ☑ 子项查询
    ☑ 物料查询
```

#### 示例：普通用户角色（只读）

勾选以下权限：

```
☑ 子系统管理（一级目录）
  ☑ 子系统列表
    ☑ 子系统查询
    ☑ 子项查询
    ☑ 物料查询
  ☑ 子系统模板
    ☑ 模板查询
    ☑ 子项查询
    ☑ 物料查询
```

## 权限验证

### 前端权限指令

代码中使用 `v-hasPermi` 指令控制按钮显示：

```vue
<!-- 新增按钮 - 需要 erp:subsystem:add 权限 -->
<el-button
  type="primary"
  icon="Plus"
  @click="handleAdd"
  v-hasPermi="['erp:subsystem:add']"
>
  新增子系统
</el-button>

<!-- 编辑按钮 - 需要 erp:subsystem:edit 权限 -->
<el-button
  link
  type="primary"
  icon="Edit"
  @click="handleUpdate"
  v-hasPermi="['erp:subsystem:edit']"
>
  编辑
</el-button>

<!-- 删除按钮 - 需要 erp:subsystem:remove 权限 -->
<el-button
  link
  type="danger"
  icon="Delete"
  @click="handleDelete"
  v-hasPermi="['erp:subsystem:remove']"
>
  删除
</el-button>
```

### 后端权限注解

后端 Controller 需要添加对应的权限注解（示例）：

```java
@RestController
@RequestMapping("/erp/subsystem")
public class SubsystemController {

    /**
     * 查询子系统列表
     */
    @PreAuthorize("@ss.hasPermi('erp:subsystem:list')")
    @GetMapping("/list")
    public TableDataInfo list(SubsystemQuery query) {
        // ...
    }

    /**
     * 新增子系统
     */
    @PreAuthorize("@ss.hasPermi('erp:subsystem:add')")
    @PostMapping
    public AjaxResult add(@RequestBody SubsystemForm form) {
        // ...
    }

    /**
     * 修改子系统
     */
    @PreAuthorize("@ss.hasPermi('erp:subsystem:edit')")
    @PutMapping
    public AjaxResult edit(@RequestBody SubsystemForm form) {
        // ...
    }

    /**
     * 删除子系统
     */
    @PreAuthorize("@ss.hasPermi('erp:subsystem:remove')")
    @DeleteMapping("/{ids}")
    public AjaxResult remove(@PathVariable String[] ids) {
        // ...
    }
}
```

## 菜单结构特点

子系统管理作为独立的一级菜单，与其他系统模块（如物料管理）平级：

```
系统菜单结构
├─ 📁 系统管理（一级目录）
│   ├─ 用户管理
│   ├─ 角色管理
│   └─ ...
├─ 📁 物料管理（一级目录）
│   └─ 物料信息
├─ 📁 化盐工艺流程（一级目录）
│   ├─ 项目管理
│   └─ ...
└─ 📁 子系统管理（一级目录）⬅️ 新增的独立模块
    ├─ 子系统列表
    ├─ 子系统模板
    ├─ 子项模板管理 ⬅️ 新增
    └─ 物料模板管理 ⬅️ 新增
```

这样的设计使得子系统管理作为独立模块，便于权限管理和功能扩展。

## 快速配置清单

### ✅ 配置检查清单

#### 子系统管理配置

- [ ] 在菜单管理中创建"子系统管理"一级菜单（parent_id=0）
- [ ] 在"子系统管理"下创建"子系统列表"子菜单
- [ ] 配置路由地址为 `subsystem`
- [ ] 配置组件路径为 `erp/subsystem/index`
- [ ] 配置权限字符为 `erp:subsystem:list`
- [ ] 创建所有子系统操作按钮权限（5 个）
- [ ] 创建所有子项操作按钮权限（4 个）
- [ ] 创建所有物料操作按钮权限（5 个）

#### 子系统模板配置

- [ ] 在"子系统管理"下创建"子系统模板"子菜单
- [ ] 配置路由地址为 `template`
- [ ] 配置组件路径为 `erp/subsystem/template/index`
- [ ] 配置权限字符为 `erp:subsystem:template:list`
- [ ] 创建所有模板操作按钮权限（5 个）
- [ ] 模板的子项和物料权限复用子系统的权限配置

#### 子项模板管理配置

- [ ] 在"子系统管理"下创建"子项模板管理"子菜单
- [ ] 配置路由地址为 `item-template`
- [ ] 配置组件路径为 `erp/subsystem/item-template/index`
- [ ] 配置权限字符为 `erp:subsystem:template:list`
- [ ] 创建所有子项操作按钮权限（5 个）
- [ ] 权限复用子系统模板的权限配置

#### 物料模板管理配置

- [ ] 在"子系统管理"下创建"物料模板管理"子菜单
- [ ] 配置路由地址为 `material-template`
- [ ] 配置组件路径为 `erp/subsystem/material-template/index`
- [ ] 配置权限字符为 `erp:subsystem:template:list`
- [ ] 创建所有物料操作按钮权限（5 个）
- [ ] 权限复用子系统模板的权限配置

#### 权限测试

- [ ] 为相关角色分配权限
- [ ] 测试子系统列表菜单是否正常显示
- [ ] 测试子系统模板菜单是否正常显示
- [ ] 测试子项模板管理菜单是否正常显示
- [ ] 测试物料模板管理菜单是否正常显示
- [ ] 测试按钮权限是否生效
- [ ] 测试不同角色的权限隔离

## 常见问题

### Q1: 菜单配置后不显示？

**A:** 检查以下几点：

1. 菜单状态是否为"正常"
2. 显示状态是否为"显示"
3. 当前登录用户的角色是否有 `erp:subsystem:list` 权限
4. 刷新浏览器缓存或重新登录

### Q2: 按钮不显示？

**A:** 检查：

1. 按钮权限配置是否正确
2. 角色是否分配了对应的按钮权限
3. 前端代码中 `v-hasPermi` 指令的权限字符是否与配置一致

### Q3: 访问页面提示无权限？

**A:** 检查：

1. 路由权限 `permissions: ['erp:subsystem:list']` 配置是否正确
2. 用户角色是否有该权限
3. 后端接口权限注解是否与前端一致

## 子系统与模板的区别

### 功能对比

| 特性       | 子系统列表                 | 子系统模板               |
| ---------- | -------------------------- | ------------------------ |
| 项目信息   | ✅ 必须关联项目            | ❌ 不关联项目            |
| 负责人信息 | ✅ 可指定负责人            | ❌ 无负责人信息          |
| 使用场景   | 实际项目的子系统管理       | 可复用的子系统配置模板   |
| 子项管理   | ✅ 支持                    | ✅ 支持                  |
| 物料管理   | ✅ 支持                    | ✅ 支持                  |
| 复制功能   | ✅ 可复制为新子系统        | ✅ 可复制为新模板        |
| 应用目标   | 应用到模板或其他项目子系统 | 应用到项目创建子系统实例 |

### 权限设计说明

子系统模板的子项和物料管理**复用**子系统的权限配置，这样设计的好处：

1. **简化权限管理**：不需要为模板单独配置子项和物料权限
2. **统一权限控制**：子系统和模板使用相同的子项/物料权限标准
3. **便于权限分配**：角色只需分配一次子项和物料权限即可

## 总结

子系统管理模块的权限配置遵循若依框架的标准权限体系：

1. **菜单权限**：控制菜单是否显示
2. **按钮权限**：控制页面内按钮是否显示
3. **角色分配**：通过角色关联权限，实现灵活的权限管理
4. **权限复用**：模板的子项和物料操作复用子系统的权限配置

配置完成后，系统会根据用户角色自动控制菜单和按钮的显示，确保权限安全。

### 模块关系图

```
子系统管理模块
├─ 子系统列表（项目子系统）
│   ├─ 包含项目信息
│   ├─ 包含负责人信息
│   ├─ 管理子项
│   └─ 管理物料
├─ 子系统模板（可复用模板）
│   ├─ 不含项目信息
│   ├─ 不含负责人信息
│   ├─ 管理子项（复用权限）
│   ├─ 管理物料（复用权限）
│   └─ 可应用到项目创建实例
└─ 子项模板管理（独立管理）⬅️ 新增
    ├─ 跨模板管理所有子项
    ├─ 支持按模板筛选
    ├─ 在子项详情中管理物料
    ├─ 物料附属于子项
    └─ 复用模板权限
```

## 物料管理使用说明

### 层级关系

物料模板的正确层级关系如下：

```
子系统模板
  └─ 子项模板
      └─ 物料模板（附属）
```

### 使用方式

#### 1. 在子项模板列表中管理

在"子项模板管理"页面：

- 查看子项列表
- 点击子项的"物料管理"或"查看详情"按钮
- 在子项详情/编辑页面中查看和管理该子项关联的物料

#### 2. 物料操作流程

**添加物料到子项**：

1. 进入子项模板管理页面
2. 找到目标子项，点击"编辑"或"物料管理"
3. 在弹出的对话框或详情页中，选择"添加物料"
4. 从物料库中选择物料，设置数量等信息
5. 保存后，物料即关联到该子项

**编辑子项的物料**：

1. 在子项详情页面，找到物料列表
2. 点击物料的"编辑"按钮
3. 修改物料数量（物料基本信息如名称、规格等来自物料库，不可修改）
4. 保存修改

**重要说明**：

- 物料的基本信息（名称、编号、规格、单位等）来自基础物料库，在此处不可修改
- 只能修改与该子项关联的信息：数量、备注等
- 如需修改物料基本信息，请到"物料管理"模块进行

**删除子项的物料**：

1. 在子项详情页面的物料列表中
2. 点击物料的"删除"按钮
3. 确认删除操作

### 权限控制

物料相关的权限按钮包含在子项模板管理中：

| 操作     | 权限标识                                 | 说明                                       |
| -------- | ---------------------------------------- | ------------------------------------------ |
| 查看物料 | `erp:subsystem:template:material:query`  | 查看子项的物料列表                         |
| 添加物料 | `erp:subsystem:template:material:add`    | 为子项添加物料（从物料库选择）             |
| 编辑物料 | `erp:subsystem:template:material:edit`   | 修改物料数量和备注（不能修改物料基本信息） |
| 删除物料 | `erp:subsystem:template:material:remove` | 从子项中删除物料关联                       |
| 导出物料 | `erp:subsystem:template:material:export` | 导出子项的物料清单                         |

**权限说明**：

- 编辑物料权限只允许修改数量、备注等与该子项关联的信息
- 物料基本信息（名称、编号、规格、单位）来自物料库，不可在此修改
- 如需修改物料基本信息，需到"物料管理"模块，需要相应的物料管理权限

### 设计理念

将物料管理集成到子项管理中的优势：

1. **层级清晰**：物料依附于子项，符合实际业务逻辑
2. **操作便捷**：在子项上下文中直接管理物料，减少页面跳转
3. **数据一致性**：确保物料始终关联到具体的子项
4. **权限统一**：物料权限作为子项权限的延伸，便于管理

## 文档更新记录

| 版本 | 日期       | 更新内容                                                 | 更新人  |
| ---- | ---------- | -------------------------------------------------------- | ------- |
| v1.0 | 2025-11-01 | 初始版本，包含子系统列表和子系统模板菜单配置             | haitang |
| v1.1 | 2025-11-05 | 新增子项模板管理菜单配置，更新菜单结构示意图             | haitang |
| v1.2 | 2025-11-05 | 调整层级结构：物料管理作为子项的附属功能，不再是独立菜单 | haitang |

## 最后更新

**最后更新日期**: 2025 年 11 月 5 日  
**文档维护**: 后端开发团队  
**技术支持**: 如有疑问请联系开发团队
