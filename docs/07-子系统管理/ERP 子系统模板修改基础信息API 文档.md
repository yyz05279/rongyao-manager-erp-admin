# ERP å­ç³»ç»Ÿæ¨¡æ¿ API æ–‡æ¡£

## ä¿®å¤è¯´æ˜

**é—®é¢˜æè¿°ï¼š**
åŸç¼–è¾‘æ¥å£åœ¨æ›´æ–°å­ç³»ç»ŸåŸºç¡€ä¿¡æ¯æ—¶ï¼Œä¼šé‡å¤æ‰§è¡Œæ·»åŠ å­é¡¹çš„æ“ä½œï¼Œå¯¼è‡´æ•°æ®é‡å¤æˆ–é€»è¾‘æ··ä¹±ã€‚

**ä¿®å¤æ–¹æ¡ˆï¼š**
é‡‡ç”¨æ¥å£æ‹†åˆ†æ–¹æ¡ˆï¼Œå°†åŸºç¡€ä¿¡æ¯æ›´æ–°å’Œå­é¡¹åˆ—è¡¨æ›´æ–°åˆ†ç¦»ä¸ºä¸¤ä¸ªç‹¬ç«‹çš„æ¥å£ã€‚

**ä¿®å¤æ—¥æœŸï¼š** 2025-01-20

---

## æ¥å£åˆ—è¡¨

### 1. æŸ¥è¯¢å­ç³»ç»Ÿæ¨¡æ¿åˆ—è¡¨

**æ¥å£åœ°å€ï¼š** `GET /erp/subsystem/template/list`

**æƒé™ï¼š** `erp:subsystem:template:list`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "templateName": "æ¨¡æ¿åç§°ï¼ˆå¯é€‰ï¼‰",
  "category": "åˆ†ç±»ï¼ˆå¯é€‰ï¼‰",
  "status": "çŠ¶æ€ï¼ˆå¯é€‰ï¼‰",
  "pageNum": 1,
  "pageSize": 10
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ",
  "data": {
    "total": 10,
    "rows": [
      {
        "id": 1,
        "templateCode": "TPL001",
        "templateName": "æ ‡å‡†å­ç³»ç»Ÿæ¨¡æ¿",
        "category": "ç”µæ°”ç³»ç»Ÿ",
        "description": "æè¿°ä¿¡æ¯",
        "status": "ACTIVE",
        "items": []
      }
    ]
  }
}
```

---

### 2. æŸ¥è¯¢å­ç³»ç»Ÿæ¨¡æ¿è¯¦æƒ…

**æ¥å£åœ°å€ï¼š** `GET /erp/subsystem/template/{id}`

**æƒé™ï¼š** `erp:subsystem:template:query`

**è·¯å¾„å‚æ•°ï¼š**
- `id`: æ¨¡æ¿IDï¼ˆå¿…å¡«ï¼‰

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "templateCode": "TPL001",
    "templateName": "æ ‡å‡†å­ç³»ç»Ÿæ¨¡æ¿",
    "category": "ç”µæ°”ç³»ç»Ÿ",
    "description": "æè¿°ä¿¡æ¯",
    "remarks": "å¤‡æ³¨ä¿¡æ¯",
    "status": "ACTIVE",
    "items": [
      {
        "id": 1,
        "itemTemplateId": 10,
        "itemName": "å­é¡¹åç§°",
        "quantity": 2,
        "sequenceNumber": 10,
        "isRequired": true
      }
    ]
  }
}
```

---

### 3. æ–°å¢å­ç³»ç»Ÿæ¨¡æ¿

**æ¥å£åœ°å€ï¼š** `POST /erp/subsystem/template`

**æƒé™ï¼š** `erp:subsystem:template:add`

**è¯·æ±‚ä½“ï¼š**
```json
{
  "templateName": "æ–°æ¨¡æ¿åç§°",
  "category": "åˆ†ç±»",
  "description": "æè¿°",
  "isStandard": true,
  "status": "DRAFT",
  "remarks": "å¤‡æ³¨",
  "items": [
    {
      "itemTemplateId": 10,
      "quantity": 2,
      "sequenceNumber": 10,
      "isRequired": true,
      "remarks": "å­é¡¹å¤‡æ³¨"
    }
  ]
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ",
  "data": {
    "id": 1,
    "templateCode": "TPL001",
    "templateName": "æ–°æ¨¡æ¿åç§°"
  }
}
```

---

### 4. ä¿®æ”¹å­ç³»ç»Ÿæ¨¡æ¿åŸºç¡€ä¿¡æ¯ â­ï¸ ä¿®å¤å

**æ¥å£åœ°å€ï¼š** `PUT /erp/subsystem/template`

**æƒé™ï¼š** `erp:subsystem:template:edit`

**åŠŸèƒ½è¯´æ˜ï¼š**
- âœ… ä»…æ›´æ–°æ¨¡æ¿çš„åŸºç¡€ä¿¡æ¯å­—æ®µï¼ˆåç§°ã€æè¿°ã€å¤‡æ³¨ã€çŠ¶æ€ç­‰ï¼‰
- âŒ ä¸å¤„ç†å­é¡¹åˆ—è¡¨ï¼ˆå³ä½¿ä¼ å…¥itemså­—æ®µä¹Ÿä¼šè¢«å¿½ç•¥ï¼‰
- ğŸ¯ é€‚ç”¨åœºæ™¯ï¼šæ›´æ–°æ¨¡æ¿åç§°ã€æ·»åŠ å¤‡æ³¨ã€ä¿®æ”¹æè¿°ç­‰åŸºç¡€ä¿¡æ¯ç»´æŠ¤æ“ä½œ

**è¯·æ±‚ä½“ï¼š**
```json
{
  "id": 1,
  "templateName": "æ›´æ–°åçš„æ¨¡æ¿åç§°",
  "description": "æ›´æ–°åçš„æè¿°",
  "remarks": "æ·»åŠ å¤‡æ³¨ä¿¡æ¯",
  "status": "ACTIVE"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ"
}
```

**æ³¨æ„äº‹é¡¹ï¼š**
1. å¿…é¡»ä¼ å…¥ `id` å­—æ®µ
2. åªä¼šæ›´æ–°ä¼ å…¥çš„å­—æ®µï¼Œæœªä¼ å…¥çš„å­—æ®µä¿æŒä¸å˜
3. ä¸ä¼šå½±å“å·²æœ‰çš„å­é¡¹åˆ—è¡¨

---

### 5. æ›´æ–°å­ç³»ç»Ÿæ¨¡æ¿å­é¡¹åˆ—è¡¨ â­ï¸ æ–°å¢æ¥å£

**æ¥å£åœ°å€ï¼š** `PUT /erp/subsystem/template/{id}/items`

**æƒé™ï¼š** `erp:subsystem:template:edit`

**åŠŸèƒ½è¯´æ˜ï¼š**
- âœ… ä¸“é—¨ç”¨äºæ›´æ–°æ¨¡æ¿çš„å­é¡¹é…ç½®
- âŒ ä¸å½±å“æ¨¡æ¿çš„åŸºç¡€ä¿¡æ¯
- ğŸ¯ é€‚ç”¨åœºæ™¯ï¼šæ·»åŠ /ä¿®æ”¹å­é¡¹ã€è°ƒæ•´å­é¡¹é¡ºåºã€è®¾ç½®å­é¡¹æ•°é‡ç­‰

**è·¯å¾„å‚æ•°ï¼š**
- `id`: æ¨¡æ¿IDï¼ˆå¿…å¡«ï¼‰

**è¯·æ±‚ä½“ï¼š**
```json
[
  {
    "itemTemplateId": 10,
    "quantity": 2,
    "sequenceNumber": 10,
    "isRequired": true,
    "remarks": "å­é¡¹å¤‡æ³¨"
  },
  {
    "itemTemplateId": 11,
    "quantity": 1,
    "sequenceNumber": 20,
    "isRequired": false
  }
]
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ"
}
```

**æ³¨æ„äº‹é¡¹ï¼š**
1. æ­¤æ“ä½œä¼šæ›¿æ¢æ¨¡æ¿çš„æ‰€æœ‰å­é¡¹ï¼ˆå…¨é‡æ›´æ–°ï¼‰
2. å¦‚æœéœ€è¦å¢é‡æ›´æ–°ï¼Œè¯·å…ˆæŸ¥è¯¢ç°æœ‰å­é¡¹ï¼Œç„¶ååˆå¹¶åå†æäº¤
3. ä¼ å…¥ç©ºæ•°ç»„ä¼šæ¸…ç©ºæ‰€æœ‰å­é¡¹

---

### 6. åˆ é™¤å­ç³»ç»Ÿæ¨¡æ¿

**æ¥å£åœ°å€ï¼š** `DELETE /erp/subsystem/template/{ids}`

**æƒé™ï¼š** `erp:subsystem:template:remove`

**è·¯å¾„å‚æ•°ï¼š**
- `ids`: æ¨¡æ¿IDæ•°ç»„ï¼Œå¤šä¸ªIDç”¨é€—å·åˆ†éš”

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "code": 200,
  "msg": "æ“ä½œæˆåŠŸ"
}
```

---

## ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯1ï¼šåˆ›å»ºæ¨¡æ¿å¹¶æ·»åŠ å­é¡¹

```javascript
// 1. åˆ›å»ºæ¨¡æ¿
const createResponse = await axios.post('/erp/subsystem/template', {
  templateName: 'æ–°æ¨¡æ¿',
  description: 'æè¿°',
  items: [
    { itemTemplateId: 10, quantity: 2 }
  ]
});

const templateId = createResponse.data.data.id;
```

### åœºæ™¯2ï¼šåªæ›´æ–°æ¨¡æ¿å¤‡æ³¨ï¼ˆä¸å½±å“å­é¡¹ï¼‰

```javascript
// 2. æ›´æ–°åŸºç¡€ä¿¡æ¯ï¼ˆä¸ä¼šé‡å¤æ·»åŠ å­é¡¹ï¼‰
await axios.put('/erp/subsystem/template', {
  id: templateId,
  templateName: 'æ–°æ¨¡æ¿',
  remarks: 'æ·»åŠ å¤‡æ³¨ä¿¡æ¯'
});
```

### åœºæ™¯3ï¼šæ›´æ–°å­é¡¹åˆ—è¡¨

```javascript
// 3. æ›´æ–°å­é¡¹åˆ—è¡¨
await axios.put(`/erp/subsystem/template/${templateId}/items`, [
  { itemTemplateId: 10, quantity: 3 },
  { itemTemplateId: 11, quantity: 1 }
]);
```

---

## é”™è¯¯ç è¯´æ˜

| é”™è¯¯ç  | è¯´æ˜ |
|--------|------|
| 500 | æ¨¡æ¿ç¼–å·å·²å­˜åœ¨ |
| 500 | å­ç³»ç»Ÿæ¨¡æ¿ä¸å­˜åœ¨ |
| 500 | å­é¡¹æ¨¡æ¿ä¸å­˜åœ¨ |
| 500 | è¯¥å­é¡¹å·²ç»æ·»åŠ åˆ°æ¨¡æ¿ä¸­ |

---

## å˜æ›´å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| v1.1 | 2025-01-20 | ä¿®å¤ç¼–è¾‘æ¥å£é€»è¾‘é—®é¢˜ï¼Œæ‹†åˆ†åŸºç¡€ä¿¡æ¯æ›´æ–°å’Œå­é¡¹æ›´æ–°æ¥å£ |
| v1.0 | 2025-11-04 | åˆå§‹ç‰ˆæœ¬ |

