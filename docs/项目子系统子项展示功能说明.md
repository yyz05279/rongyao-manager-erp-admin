# 项目子系统子项展示功能说明

## 功能概述

在项目子系统详情弹窗中展示子项（items）数据列表，用户可以查看每个子项的详细信息。

## 技术实现

### 1. 类型定义

在 `/src/api/erp/saltprocess/equipment-system/types.ts` 中新增了以下类型定义：

```typescript
/**
 * 项目子系统子项VO（详情接口返回的子项数据）
 */
export interface ProjectSubsystemItemVO {
  id: string | number;                // 子项ID
  itemCode: string;                   // 子项编码
  itemName: string;                   // 子项名称
  itemType?: string;                  // 子项类型（组件/部件等）
  quantity: number | string;          // 数量（支持字符串类型如 "1.00"）
  unit: string;                       // 单位
  unitWeight: number | string;        // 单件重量（支持字符串类型如 "0.00"）
  totalWeight: number | string;       // 总重量（支持字符串类型如 "0.00"）
  materialCount: number;              // 材料数量
  status: string;                     // 状态（DRAFT-草稿，ACTIVE-启用等）
  sequenceNumber?: number;            // 序号
  specification?: string;             // 规格型号
  description?: string;               // 描述
  remarks?: string;                   // 备注
}
```

同时更新了 `ProjectSubsystemVO` 接口，添加了 `items` 字段：

```typescript
export interface ProjectSubsystemVO {
  // ... 其他字段
  items?: ProjectSubsystemItemVO[];  // 子项列表（详情接口返回）
}
```

### 2. 子项列表组件

创建了专门用于详情展示的只读子项列表组件：

**文件路径：** `/src/views/erp/saltprocess/equipment-system/components/ProjectSubsystemItemList.vue`

**组件特性：**
- 只读展示，不包含编辑功能
- 以表格形式清晰展示所有子项数据
- 支持加载状态显示
- 空状态友好提示
- 响应式设计

**Props 接口：**
```typescript
interface Props {
  /** 子项列表数据 */
  items?: ProjectSubsystemItemVO[];
  /** 加载状态 */
  loading?: boolean;
}
```

**展示字段：**
- 序号（sequenceNumber）
- 子项编码（itemCode）
- 子项名称（itemName）
- 子项类型（itemType）- 带颜色标签
- 数量（quantity）
- 单位（unit）
- 单件重量（unitWeight）- 格式化显示
- 总重量（totalWeight）- 格式化显示
- 材料数量（materialCount）- 带颜色标签
- 状态（status）- 带颜色标签

### 3. 详情页面集成

在 `/src/views/erp/saltprocess/equipment-system/components/ProjectSubsystemDetail.vue` 中集成了子项列表组件：

```vue
<template>
  <div class="project-subsystem-detail" v-loading="loading">
    <!-- 基本信息 -->
    <el-descriptions :column="2" border class="mb-4">
      <!-- ... 基本信息字段 -->
    </el-descriptions>

    <!-- 子项列表 -->
    <ProjectSubsystemItemList
      v-if="detail.items && detail.items.length > 0"
      :items="detail.items"
      :loading="loading"
    />
  </div>
</template>
```

## API 接口

**接口地址：** `/saltprocess/projectSubsystem/{id}`

**请求方法：** GET

**返回数据结构示例：**
```json
{
  "code": 200,
  "msg": "操作成功",
  "data": {
    "id": "1993217780953866242",
    "subsystemName": "平面输送机",
    "category": "机械",
    "itemCount": 2,
    "items": [
      {
        "id": "1993217781247467521",
        "itemCode": "ITEM-IEILPHRPUWBB",
        "itemName": "粉碎机本体",
        "itemType": "组件",
        "quantity": "1.00",
        "unit": "套",
        "unitWeight": "0.00",
        "totalWeight": "0.00",
        "materialCount": 0,
        "status": "DRAFT",
        "sequenceNumber": 10
      }
    ]
  }
}
```

## 使用说明

### 1. 查看子项列表

1. 在项目设备系统管理页面，点击某个子系统的"查看"按钮
2. 在弹出的详情对话框中，基本信息下方会显示子项列表
3. 如果该子系统没有子项，则不显示子项列表区域

### 2. 子项数据展示

- **序号排序：** 优先使用 `sequenceNumber` 字段，如果没有则使用表格索引
- **类型标签：** 不同子项类型显示不同颜色的标签
- **重量格式化：** 自动格式化为两位小数并添加 "kg" 单位
- **状态标签：** 根据状态显示不同颜色（草稿-灰色，启用-绿色等）
- **材料数量：** 大于0时显示橙色标签，等于0时显示灰色文本

## 技术规范遵循

本功能开发严格遵循项目编码规范：

✅ 使用 Vue 3 Composition API 和 `<script setup>` 语法  
✅ 使用 TypeScript 进行类型定义  
✅ 组件命名采用 PascalCase  
✅ 文件命名采用 kebab-case  
✅ 清晰的 Props 接口定义  
✅ 响应式设计，适配不同屏幕尺寸  
✅ 使用 Element Plus 组件库  
✅ SCSS 样式预处理器  
✅ BEM 命名规范  

## 后续优化建议

1. **子项详情查看：** 可以添加点击子项行查看更详细信息的功能
2. **物料列表展示：** 可以在子项行展开时显示该子项的物料列表
3. **导出功能：** 添加子项列表导出为 Excel 的功能
4. **搜索过滤：** 如果子项数量较多，可以添加搜索和过滤功能
5. **分页支持：** 如果子项数量非常多，可以考虑添加分页功能

## 相关文件

- 类型定义：`/src/api/erp/saltprocess/equipment-system/types.ts`
- 子项列表组件：`/src/views/erp/saltprocess/equipment-system/components/ProjectSubsystemItemList.vue`
- 详情页面：`/src/views/erp/saltprocess/equipment-system/components/ProjectSubsystemDetail.vue`
- API 接口：`/src/api/erp/saltprocess/subsystem/index.ts`

## 测试建议

1. 测试有子项数据的子系统详情展示
2. 测试无子项数据的子系统详情展示
3. 测试加载状态显示
4. 测试不同子项类型的标签颜色
5. 测试不同状态的标签颜色
6. 测试重量和数量的格式化显示
7. 测试响应式布局在不同屏幕尺寸下的表现

