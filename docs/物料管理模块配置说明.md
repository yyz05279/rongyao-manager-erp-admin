# 物料管理模块配置说明

## 模块概述

物料管理模块已创建完成，参照产品管理模块的布局和功能设计，专门用于管理物料清单明细信息。

## 文件结构

```
src/
├── api/erp/material/material/
│   ├── index.ts          # API接口定义
│   └── types.ts          # 类型定义
└── views/erp/material/material/
    └── index.vue         # 视图页面
```

## 菜单配置信息

根据产品管理模块的配置方式，物料管理模块的菜单配置信息如下：

### 父级菜单：物料管理

| 配置项   | 配置值                    |
| -------- | ------------------------- |
| 菜单名称 | 物料管理                  |
| 菜单类型 | 目录(M)                   |
| 菜单图标 | shopping-cart（可自定义） |
| 菜单排序 | 根据实际需求调整          |
| 显示状态 | 显示                      |
| 菜单状态 | 正常                      |

### 子菜单：物料信息

| 配置项   | 配置值                      |
| -------- | --------------------------- |
| 菜单名称 | 物料信息                    |
| 上级菜单 | 物料管理                    |
| 菜单类型 | 菜单(C)                     |
| 路由地址 | material                    |
| 组件路径 | erp/material/material/index |
| 权限标识 | erp:material:list           |
| 菜单图标 | list（可自定义）            |
| 菜单排序 | 1                           |
| 是否外链 | 否                          |
| 是否缓存 | 是                          |
| 显示状态 | 显示                        |
| 菜单状态 | 正常                        |

## 权限配置

### 按钮权限列表

需要在系统管理 -> 菜单管理 -> 物料信息菜单下，添加以下按钮权限：

| 权限名称 | 权限标识                 | 备注             |
| -------- | ------------------------ | ---------------- |
| 物料查询 | erp:material:item:list   | 物料列表查询权限 |
| 物料新增 | erp:material:item:add    | 新增物料权限     |
| 物料修改 | erp:material:item:edit   | 修改物料权限     |
| 物料删除 | erp:material:item:remove | 删除物料权限     |
| 物料导出 | erp:material:item:export | 导出物料权限     |

## 路由配置

如果使用前端路由配置，可以参考以下配置（通常在 `src/router/index.ts` 或路由模块中）：

```typescript
{
  path: '/material',
  component: Layout,
  redirect: '/material/material',
  name: 'Material',
  meta: {
    title: '物料管理',
    icon: 'shopping-cart'
  },
  children: [
    {
      path: 'material',
      component: () => import('@/views/erp/material/material/index.vue'),
      name: 'MaterialInfo',
      meta: {
        title: '物料信息',
        icon: 'list',
        activeMenu: '/material/material'
      }
    }
  ]
}
```

## API 接口路径

物料管理模块使用的是物料清单明细管理 API 接口，基础路径为：

```
/erp/saltprocess/material/item
```

### 主要接口列表

| 接口名称     | 请求方法 | 接口路径                                                  | 说明                     |
| ------------ | -------- | --------------------------------------------------------- | ------------------------ |
| 查询物料列表 | GET      | /erp/saltprocess/material/item/list                       | 分页查询物料列表         |
| 查询物料详情 | GET      | /erp/saltprocess/material/item/{id}                       | 根据 ID 查询物料详情     |
| 新增物料     | POST     | /erp/saltprocess/material/item                            | 新增物料信息             |
| 修改物料     | PUT      | /erp/saltprocess/material/item                            | 修改物料信息             |
| 批量更新物料 | PUT      | /erp/saltprocess/material/item/batch                      | 批量更新物料信息         |
| 删除物料     | DELETE   | /erp/saltprocess/material/item/{ids}                      | 删除物料信息（支持批量） |
| 更新物料数量 | PUT      | /erp/saltprocess/material/item/{id}/quantity              | 更新物料数量             |
| 查询易碎品   | GET      | /erp/saltprocess/material/item/fragile/{shippingListId}   | 查询易碎品列表           |
| 查询危险品   | GET      | /erp/saltprocess/material/item/hazardous/{shippingListId} | 查询危险品列表           |
| 导出物料     | POST     | /erp/saltprocess/material/item/export                     | 导出物料列表             |

## 字段说明

### 物料信息主要字段

| 字段名          | 类型       | 说明                     | 是否必填 |
| --------------- | ---------- | ------------------------ | -------- |
| id              | Long       | 物料编号                 | 系统生成 |
| shippingListId  | Long       | 物料清单 ID              | 否       |
| itemCode        | String     | 物料编码                 | 否       |
| itemName        | String     | 物料名称                 | 是       |
| specification   | String     | 规格型号                 | 否       |
| equipmentType   | String     | 设备类型                 | 否       |
| quantity        | Integer    | 数量                     | 是       |
| unit            | String     | 单位                     | 否       |
| unitWeight      | BigDecimal | 单重（kg）               | 否       |
| totalWeight     | BigDecimal | 总重（kg）               | 否       |
| unitVolume      | BigDecimal | 单体积（m³）             | 否       |
| totalVolume     | BigDecimal | 总体积（m³）             | 否       |
| manufacturer    | String     | 制造商                   | 否       |
| model           | String     | 型号                     | 否       |
| serialNumber    | String     | 序列号                   | 否       |
| productionDate  | String     | 生产日期                 | 否       |
| isFragile       | Integer    | 是否易碎品（0-否，1-是） | 否       |
| isHazardous     | Integer    | 是否危险品（0-否，1-是） | 否       |
| packagingMethod | String     | 包装方式                 | 否       |
| remarks         | String     | 备注                     | 否       |
| version         | Integer    | 版本号（乐观锁）         | 系统维护 |

## 功能特性

1. **基础 CRUD 操作**

   - 物料信息的新增、修改、删除、查询
   - 支持批量删除和批量更新

2. **高级查询**

   - 按物料名称模糊查询
   - 按物料编码查询
   - 按设备类型查询
   - 按生产日期范围查询

3. **特殊物料管理**

   - 易碎品标识和查询
   - 危险品标识和查询

4. **数据导出**

   - 支持将物料列表导出为 Excel 文件

5. **乐观锁机制**
   - 通过版本号防止并发更新冲突

## 配置步骤

### 1. 后台配置（若使用数据库菜单管理）

在系统管理 -> 菜单管理中，按照以下步骤配置：

1. **添加父级菜单**

   - 点击"新增"按钮
   - 填写菜单名称：物料管理
   - 选择菜单类型：目录
   - 选择菜单图标
   - 设置排序号
   - 保存

2. **添加子菜单**

   - 选择"物料管理"父菜单
   - 点击"新增"按钮
   - 填写菜单名称：物料信息
   - 选择菜单类型：菜单
   - 填写路由地址：material
   - 填写组件路径：erp/material/material/index
   - 填写权限标识：erp:material:list
   - 保存

3. **添加按钮权限**
   - 选择"物料信息"菜单
   - 为每个操作添加按钮权限（查询、新增、修改、删除、导出）

### 2. 角色权限配置

在系统管理 -> 角色管理中：

1. 选择需要授权的角色
2. 点击"修改"按钮
3. 在菜单权限树中勾选"物料管理"及相关权限
4. 保存配置

### 3. 验证配置

1. 使用配置了权限的用户登录系统
2. 在左侧菜单栏中应该能看到"物料管理" -> "物料信息"菜单
3. 点击进入，测试各项功能是否正常

## 注意事项

1. **权限标识统一性**

   - 确保前端页面中的 `v-hasPermi` 指令使用的权限标识与后台配置的权限标识完全一致

2. **路由路径**

   - 组件路径不需要加 `.vue` 后缀
   - 路由地址和组件路径要对应

3. **接口权限**

   - 后端接口也需要配置相应的权限注解
   - 确保前后端权限标识保持一致

4. **图标选择**
   - 菜单图标可以根据实际 UI 设计选择合适的图标
   - 建议使用 Element Plus 图标库或项目自定义图标

## 参考截图配置（产品管理模块）

根据您提供的截图，产品管理模块的配置如下：

```
产品管理（父级）
├── 产品信息
│   ├── 权限标识: erp:product:list
│   ├── 路由: erp/product/product/index
│   └── 排序: 1
├── 产品分类
│   ├── 权限标识: erp:category:list
│   ├── 路由: erp/product/category/index
│   └── 排序: 2
└── 产品单位
    ├── 权限标识: erp:unit:list
    ├── 路由: erp/product/unit/index
    └── 排序: 3
```

物料管理模块可以参照此结构进行配置，目前已创建物料信息功能，后续可根据需要扩展物料分类、物料单位等子功能。

## 扩展建议

如需完善物料管理模块，可以考虑添加：

1. **物料分类管理**

   - 路径：`src/views/erp/material/category/index.vue`
   - 权限：`erp:material:category:list`

2. **物料单位管理**

   - 路径：`src/views/erp/material/unit/index.vue`
   - 权限：`erp:material:unit:list`

3. **物料统计分析**
   - 按设备类型统计
   - 按制造商统计
   - 物料库存统计

---

## 完成清单

- [x] 创建 API 接口文件
- [x] 创建类型定义文件
- [x] 创建视图页面文件
- [x] 编写配置文档
- [ ] 后台菜单配置（需在系统中手动配置）
- [ ] 角色权限配置（需在系统中手动配置）
- [ ] 功能测试验证

**创建日期**: 2025-10-28  
**版本**: v1.0.0
