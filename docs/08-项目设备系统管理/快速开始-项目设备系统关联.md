# 快速开始：项目设备系统关联功能

## 5 分钟快速集成指南

### 步骤 1：导入组件（1 分钟）

在你的页面组件中导入关联弹窗组件：

```vue
<script setup lang="ts">
import ProjectEquipmentSystemForm from './components/ProjectEquipmentSystemForm.vue';
import { ref } from 'vue';

const dialogVisible = ref(false);
</script>
```

### 步骤 2：添加到模板（1 分钟）

在模板中添加组件和触发按钮：

```vue
<template>
  <div>
    <!-- 触发按钮 -->
    <el-button type="primary" icon="Plus" @click="dialogVisible = true">
      关联设备系统
    </el-button>

    <!-- 关联弹窗 -->
    <ProjectEquipmentSystemForm
      v-model:visible="dialogVisible"
      @success="handleSuccess"
    />
  </div>
</template>
```

### 步骤 3：处理成功事件（1 分钟）

添加成功回调处理：

```vue
<script setup lang="ts">
import { ElMessage } from 'element-plus';

const handleSuccess = () => {
  ElMessage.success('设备系统关联成功');
  // 刷新你的数据列表
  loadData();
};

const loadData = () => {
  // 你的数据加载逻辑
};
</script>
```

### 步骤 4：测试功能（2 分钟）

1. 点击"关联设备系统"按钮
2. 选择一个项目
3. 勾选一个或多个模板
4. 点击"确定"
5. 查看是否显示成功提示

## 完整示例代码

```vue
<template>
  <div class="equipment-system-page">
    <!-- 页面头部 -->
    <div class="page-header">
      <h2>项目设备系统管理</h2>
      <el-button type="primary" icon="Plus" @click="showDialog">
        关联设备系统
      </el-button>
    </div>

    <!-- 数据表格 -->
    <el-table :data="tableData" border>
      <el-table-column prop="systemCode" label="系统编码" />
      <el-table-column prop="systemName" label="系统名称" />
      <el-table-column prop="projectName" label="所属项目" />
    </el-table>

    <!-- 关联弹窗 -->
    <ProjectEquipmentSystemForm
      v-model:visible="dialogVisible"
      @success="handleSuccess"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue';
import { ElMessage } from 'element-plus';
import ProjectEquipmentSystemForm from './components/ProjectEquipmentSystemForm.vue';
import { listProjectEquipmentSystem } from '@/api/erp/saltprocess/equipment-system';

const dialogVisible = ref(false);
const tableData = ref([]);

const showDialog = () => {
  dialogVisible.value = true;
};

const handleSuccess = () => {
  ElMessage.success('设备系统关联成功');
  loadData();
};

const loadData = async () => {
  try {
    const res = await listProjectEquipmentSystem();
    tableData.value = res.data.rows || [];
  } catch (error) {
    ElMessage.error('加载数据失败');
  }
};

onMounted(() => {
  loadData();
});
</script>

<style scoped lang="scss">
.equipment-system-page {
  padding: 20px;

  .page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }
}
</style>
```

## 常见问题

### Q1: 弹窗打不开？
**A:** 检查 `v-model:visible` 绑定是否正确。

### Q2: 项目列表为空？
**A:** 确保系统中有盐化项目数据，检查接口 `/erp/saltprocess/project/list` 是否正常。

### Q3: 模板列表为空？
**A:** 确保有启用状态的设备系统模板，检查接口 `/erp/saltprocess/equipmentSystemTemplate/list?status=ACTIVE` 是否正常。

### Q4: 提交失败？
**A:** 
1. 检查后端接口 `/erp/saltprocess/projectEquipmentSystem/create-from-templates` 是否已实现
2. 检查用户是否有 `erp:saltprocess:projectEquipmentSystem:add` 权限
3. 查看浏览器控制台和后端日志获取详细错误信息

### Q5: 如何自定义样式？
**A:** 组件使用了 scoped 样式，你可以在父组件中使用 `:deep()` 选择器覆盖：

```scss
:deep(.project-equipment-system-form) {
  // 自定义样式
}
```

## 接口依赖检查清单

在使用前，请确保以下接口已实现：

- [ ] `GET /erp/saltprocess/project/list` - 项目列表
- [ ] `GET /erp/saltprocess/equipmentSystemTemplate/list` - 模板列表
- [ ] `POST /erp/saltprocess/projectEquipmentSystem/create-from-templates` - 批量创建

## 下一步

- 查看 [组件使用说明](./项目设备系统关联组件使用说明.md) 了解更多配置选项
- 查看 [测试指南](./项目设备系统关联功能测试指南.md) 进行完整测试
- 查看 [实现总结](./项目设备系统关联功能实现总结.md) 了解技术细节

## 需要帮助？

如果遇到问题，请：
1. 检查浏览器控制台错误信息
2. 检查后端日志
3. 参考测试指南进行排查
4. 联系开发团队

