# æ‰¹é‡æ·»åŠ å­ç³»ç»Ÿæ¥å£å‚æ•°è°ƒæ•´å®Œæˆ

## ğŸ“Œ ä¿®æ”¹æ¦‚è¿°

æ ¹æ®åç«¯æ¥å£æ–‡æ¡£è¦æ±‚ï¼Œè°ƒæ•´æ‰¹é‡æ·»åŠ å­ç³»ç»Ÿæ¥å£çš„è°ƒç”¨æ–¹å¼ï¼Œä»ä¼ é€’ç®€å•çš„æ¨¡æ¿IDæ•°ç»„æ”¹ä¸ºä¼ é€’å®Œæ•´çš„å­ç³»ç»Ÿé…ç½®å¯¹è±¡æ•°ç»„ã€‚

**ä¿®æ”¹æ—¥æœŸ**: 2025-11-25  
**ä¿®æ”¹ç±»å‹**: æ¥å£å‚æ•°è°ƒæ•´  
**å½±å“æ–‡ä»¶**: 
- `src/api/erp/saltprocess/equipment-system/index.ts`
- `src/views/erp/saltprocess/equipment-system/components/ProjectSubsystemManagement.vue`

---

## ğŸ”„ ä¿®æ”¹èƒŒæ™¯

### åç«¯æ¥å£è¦æ±‚

æ ¹æ®åç«¯æ¥å£æ–‡æ¡£ï¼Œæ‰¹é‡æ·»åŠ å­ç³»ç»Ÿæ¥å£éœ€è¦æ¥æ”¶å®Œæ•´çš„å­ç³»ç»Ÿé…ç½®å¯¹è±¡æ•°ç»„ï¼š

```bash
curl -X POST "http://localhost:8080/erp/saltprocess/projectEquipmentSystem/{systemId}/subsystems/batch" \
  -H "Content-Type: application/json" \
  -d '[
    {
      "templateId": 1001,
      "subsystemName": "å¹³é¢è¾“é€æœº",
      "category": "è¾“é€è®¾å¤‡",
      "sequenceNumber": 1
    },
    {
      "templateId": 1002,
      "subsystemName": "ç²‰ç¢æœº",
      "category": "ç²‰ç¢è®¾å¤‡",
      "sequenceNumber": 2
    }
  ]'
```

### ä¿®æ”¹å‰çš„é—®é¢˜

ä¹‹å‰çš„å®ç°åªä¼ é€’æ¨¡æ¿IDæ•°ç»„ï¼Œä¸åç«¯æ¥å£è¦æ±‚ä¸ç¬¦ã€‚

---

## âœ… å®Œæˆçš„ä¿®æ”¹

### 1. æ–°å¢æ¥å£ç±»å‹å®šä¹‰

**æ–‡ä»¶**: `src/api/erp/saltprocess/equipment-system/index.ts`

```typescript
export interface BatchAddSubsystemForm {
  templateId: string | number;          // å­ç³»ç»Ÿæ¨¡æ¿ID
  subsystemName: string;                // å­ç³»ç»Ÿåç§°
  subsystemCode?: string;               // å­ç³»ç»Ÿç¼–ç ï¼ˆå¯é€‰ï¼‰
  category?: string;                    // å­ç³»ç»Ÿåˆ†ç±»ï¼ˆå¯é€‰ï¼‰
  subsystemType?: string;               // å­ç³»ç»Ÿç±»å‹ï¼ˆå¯é€‰ï¼‰
  description?: string;                 // æè¿°ï¼ˆå¯é€‰ï¼‰
  status?: string;                      // çŠ¶æ€ï¼ˆå¯é€‰ï¼‰
  sequenceNumber?: number;              // åºå·ï¼ˆå¯é€‰ï¼‰
  remarks?: string;                     // å¤‡æ³¨ï¼ˆå¯é€‰ï¼‰
}
```

### 2. æ›´æ–°æ¥å£å‡½æ•°

**ä¿®æ”¹å‰**:
```typescript
batchAddSubsystemTemplates(systemId, templateIds: Array<string | number>)
data: { templateIds }  // âŒ é”™è¯¯æ ¼å¼
```

**ä¿®æ”¹å**:
```typescript
batchAddSubsystemTemplates(systemId, subsystemsData: BatchAddSubsystemForm[])
data: subsystemsData  // âœ… æ­£ç¡®æ ¼å¼ï¼šç›´æ¥ä¼ é€’æ•°ç»„
```

### 3. é‡æ„ç»„ä»¶æ–¹æ³•

**ä¿®æ”¹å‰**:
```typescript
const templateIds = selectedTemplates.map(template => template.id);
await batchAddSubsystemTemplates(props.systemId, templateIds);
```

**ä¿®æ”¹å**:
```typescript
const subsystemsData: BatchAddSubsystemForm[] = selectedTemplates.map((template, index) => ({
  templateId: template.id,
  subsystemName: template.templateName || '',
  subsystemCode: template.templateCode || '',
  category: template.category || '',
  description: template.description || '',
  status: 'ACTIVE',
  sequenceNumber: index + 1,
  remarks: `ä»æ¨¡æ¿åˆ›å»ºï¼š${template.templateName}`
}));

await batchAddSubsystemTemplates(props.systemId, subsystemsData);
```

---

## ğŸ“Š æ•°æ®æ˜ å°„

| åç«¯å­—æ®µ | æ¥æº | è¯´æ˜ |
|---------|------|------|
| `templateId` | `template.id` | æ¨¡æ¿ID |
| `subsystemName` | `template.templateName` | å­ç³»ç»Ÿåç§° |
| `subsystemCode` | `template.templateCode` | å­ç³»ç»Ÿç¼–ç  |
| `category` | `template.category` | åˆ†ç±» |
| `description` | `template.description` | æè¿° |
| `status` | å›ºå®š `'ACTIVE'` | çŠ¶æ€ |
| `sequenceNumber` | `index + 1` | åºå· |
| `remarks` | åŠ¨æ€ç”Ÿæˆ | å¤‡æ³¨ |

---

## ğŸ“‹ è¯·æ±‚æ•°æ®ç¤ºä¾‹

### ä¿®æ”¹å‰ï¼ˆé”™è¯¯ï¼‰
```json
{
  "templateIds": [1001, 1002, 1003]
}
```

### ä¿®æ”¹åï¼ˆæ­£ç¡®ï¼‰
```json
[
  {
    "templateId": 1001,
    "subsystemName": "å¹³é¢è¾“é€æœº",
    "subsystemCode": "CONV-001",
    "category": "è¾“é€è®¾å¤‡",
    "status": "ACTIVE",
    "sequenceNumber": 1,
    "remarks": "ä»æ¨¡æ¿åˆ›å»ºï¼šå¹³é¢è¾“é€æœº"
  },
  {
    "templateId": 1002,
    "subsystemName": "ç²‰ç¢æœº",
    "subsystemCode": "CRUSH-001",
    "category": "ç²‰ç¢è®¾å¤‡",
    "status": "ACTIVE",
    "sequenceNumber": 2,
    "remarks": "ä»æ¨¡æ¿åˆ›å»ºï¼šç²‰ç¢æœº"
  }
]
```

---

## ğŸ“ æ€»ç»“

âœ… **æ–°å¢ç±»å‹å®šä¹‰**: `BatchAddSubsystemForm` æ¥å£  
âœ… **æ›´æ–°æ¥å£ç­¾å**: ä» `templateIds[]` æ”¹ä¸º `BatchAddSubsystemForm[]`  
âœ… **å®Œå–„æ•°æ®æ˜ å°„**: æ„å»ºå®Œæ•´çš„å­ç³»ç»Ÿé…ç½®å¯¹è±¡  
âœ… **å¢å¼ºæ—¥å¿—è¾“å‡º**: è¯¦ç»†è®°å½•æ„å»ºè¿‡ç¨‹  
âœ… **ç¬¦åˆåç«¯è¦æ±‚**: è¯·æ±‚ä½“æ ¼å¼æ­£ç¡®  

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-11-25  
**ä½œè€…**: Augment Agent

