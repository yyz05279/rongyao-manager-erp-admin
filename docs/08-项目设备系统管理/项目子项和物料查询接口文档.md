# 项目设备系统子项和物料查询接口文档

## 文档信息

-   **版本**: v1.0
-   **更新日期**: 2025 年 1 月
-   **基础路径**: `/erp/saltprocess`
-   **认证方式**: Sa-Token 权限控制
-   **数据格式**: JSON

## 1. 项目子项管理接口

### 1.1 查询项目子项列表（分页）

**接口地址**: `GET /erp/saltprocess/projectItem/list`

**权限标识**: `erp:saltprocess:projectItem:list`

**功能描述**: 分页查询项目设备系统下的所有子项

**请求参数**:

| 参数名             | 类型    | 必填 | 说明               |
| ------------------ | ------- | ---- | ------------------ |
| pageNum            | Integer | 是   | 页码               |
| pageSize           | Integer | 是   | 每页数量           |
| projectSystemId    | Long    | 否   | 项目设备系统 ID    |
| projectSubsystemId | Long    | 否   | 项目子系统 ID      |
| itemName           | String  | 否   | 子项名称           |
| status             | String  | 否   | 状态(DRAFT/ACTIVE) |

**成功响应** (200):

```json
{
    "code": 200,
    "msg": "查询成功",
    "total": 50,
    "rows": [
        {
            "id": 1,
            "projectSystemId": 10,
            "projectSubsystemId": 100,
            "itemCode": "ITEM-ABC123456",
            "itemName": "冷凝器",
            "itemType": "设备",
            "specification": "型号XYZ-100",
            "quantity": 2,
            "unit": "台",
            "status": "ACTIVE",
            "sequenceNumber": 1,
            "createTime": "2025-01-10T10:30:00"
        }
    ]
}
```

### 1.2 查询项目子项详情

**接口地址**: `GET /erp/saltprocess/projectItem/{id}`

**权限标识**: `erp:saltprocess:projectItem:query`

**路径参数**: `id` (Long) - 子项 ID

**成功响应** (200):

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": {
        "id": 1,
        "projectSystemId": 10,
        "projectSubsystemId": 100,
        "itemCode": "ITEM-ABC123456",
        "itemName": "冷凝器",
        "itemType": "设备",
        "specification": "型号XYZ-100",
        "quantity": 2,
        "unit": "台",
        "unitWeight": 500.5,
        "status": "ACTIVE",
        "sequenceNumber": 1,
        "createTime": "2025-01-10T10:30:00"
    }
}
```

## 2. 项目物料管理接口

### 2.1 查询项目物料列表（分页）

**接口地址**: `GET /erp/saltprocess/projectMaterial/list`

**权限标识**: `erp:saltprocess:projectMaterial:list`

**功能描述**: 分页查询项目子项下的所有物料

**请求参数**:

| 参数名        | 类型    | 必填 | 说明        |
| ------------- | ------- | ---- | ----------- |
| pageNum       | Integer | 是   | 页码        |
| pageSize      | Integer | 是   | 每页数量    |
| projectItemId | Long    | 否   | 项目子项 ID |
| materialCode  | String  | 否   | 物料编码    |
| materialName  | String  | 否   | 物料名称    |
| status        | String  | 否   | 状态        |

### 2.2 查询项目物料详情

**接口地址**: `GET /erp/saltprocess/projectMaterial/{id}`

**权限标识**: `erp:saltprocess:projectMaterial:query`

**路径参数**: `id` (Long) - 物料 ID

**成功响应** (200):

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": {
        "id": 1,
        "projectItemId": 10,
        "materialCode": "MAT-ABC123456",
        "materialName": "冷凝管",
        "specification": "Φ20×3×4000",
        "materialType": "金属配件",
        "unit": "根",
        "quantity": 100,
        "manufacturer": "海泰制造",
        "model": "HT-CDG-100",
        "status": "ACTIVE"
    }
}
```

## 3. 项目子系统层级查询接口（新增）

### 3.1 查询项目子系统下的子项列表

**接口地址**: `GET /erp/saltprocess/projectEquipmentSystem/subsystem/{projectSubsystemId}/items`

**权限标识**: `erp:saltprocess:projectEquipmentSystem:query`

**功能描述**: 根据项目子系统 ID 查询该子系统下的所有子项列表

**路径参数**: `projectSubsystemId` (Long) - 项目子系统 ID

**成功响应** (200):

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "id": 1,
            "itemCode": "ITEM-ABC123456",
            "itemName": "冷凝器",
            "quantity": 2,
            "unit": "台",
            "status": "ACTIVE"
        }
    ]
}
```

### 3.2 查询项目子项下的物料列表

**接口地址**: `GET /erp/saltprocess/projectEquipmentSystem/item/{projectItemId}/materials`

**权限标识**: `erp:saltprocess:projectEquipmentSystem:query`

**功能描述**: 根据项目子项 ID 查询该子项下的所有物料列表

**成功响应** (200):

```json
{
    "code": 200,
    "msg": "查询成功",
    "data": [
        {
            "id": 1,
            "materialCode": "MAT-XYZ001",
            "materialName": "冷凝管",
            "quantity": 50,
            "unit": "根"
        }
    ]
}
```

## 4. 错误响应说明

| 错误码 | 说明       | HTTP 状态                 |
| ------ | ---------- | ------------------------- |
| 200    | 成功       | 200 OK                    |
| 400    | 参数错误   | 400 Bad Request           |
| 401    | 认证失败   | 401 Unauthorized          |
| 403    | 权限不足   | 403 Forbidden             |
| 404    | 资源不存在 | 404 Not Found             |
| 500    | 服务器错误 | 500 Internal Server Error |

## 5. 数据模型

### ErpSaltProjectItem (项目子项)

| 字段     | 类型    | 说明     |
| -------- | ------- | -------- |
| id       | Long    | 主键     |
| itemCode | String  | 子项编码 |
| itemName | String  | 子项名称 |
| itemType | String  | 子项类型 |
| quantity | Integer | 数量     |
| unit     | String  | 单位     |
| status   | String  | 状态     |

### ErpSaltProjectMaterial (项目物料)

| 字段         | 类型    | 说明     |
| ------------ | ------- | -------- |
| id           | Long    | 主键     |
| materialCode | String  | 物料编码 |
| materialName | String  | 物料名称 |
| quantity     | Integer | 数量     |
| unit         | String  | 单位     |
| status       | String  | 状态     |
