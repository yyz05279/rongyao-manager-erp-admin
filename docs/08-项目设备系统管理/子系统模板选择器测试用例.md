# 子系统模板选择器测试用例

## 测试目标
验证 `ProjectSubsystemSelector` 组件的数据提交过滤逻辑是否正常工作。

## 测试环境
- **组件**: ProjectSubsystemSelector.vue
- **功能**: 添加子系统模板到项目设备系统
- **测试日期**: 2025-11-25

## 测试用例

### 用例1：正常添加新模板
**测试步骤**:
1. 进入项目设备系统详情页面
2. 点击"添加子系统"按钮
3. 选择3个未添加的模板
4. 点击"确认"按钮

**预期结果**:
- ✅ 成功提交3个模板
- ✅ 无额外提示信息
- ✅ 对话框关闭
- ✅ 子系统列表更新

**控制台输出**:
```
🎯 [ProjectSubsystemSelector.handleConfirm] 确认添加子系统模板
📊 原始选中数量: 3
📊 过滤后数量: 3
📋 将要添加的模板: [...]
```

---

### 用例2：部分模板已添加
**前置条件**: 已添加2个子系统模板（ID: 1001, 1002）

**测试步骤**:
1. 进入项目设备系统详情页面
2. 点击"添加子系统"按钮
3. 观察已添加的模板是否显示"已添加"标签
4. 验证已添加的模板复选框是否被禁用
5. 尝试选择5个模板（包含已添加的2个）
6. 点击"确认"按钮

**预期结果**:
- ✅ 已添加的模板显示绿色"已添加"标签
- ✅ 已添加的模板复选框被禁用，无法选中
- ✅ 如果能选中，提交时会被过滤
- ✅ 显示提示："已过滤 2 个已添加的模板，将添加 3 个新模板"
- ✅ 实际只提交3个新模板

**控制台输出**:
```
🎯 [ProjectSubsystemSelector.handleConfirm] 确认添加子系统模板
📊 原始选中数量: 5
📊 过滤后数量: 3
📋 将要添加的模板: [...]
```

---

### 用例3：全部模板已添加
**前置条件**: 已添加所有可选的子系统模板

**测试步骤**:
1. 进入项目设备系统详情页面
2. 点击"添加子系统"按钮
3. 观察所有模板是否都显示"已添加"标签
4. 验证所有模板的复选框是否都被禁用
5. 如果能选中某些模板，点击"确认"按钮

**预期结果**:
- ✅ 所有模板显示绿色"已添加"标签
- ✅ 所有模板的复选框被禁用
- ✅ 如果能选中，显示警告："所选模板均已添加，请选择其他模板"
- ✅ 不提交任何数据
- ✅ 对话框不关闭

---

### 用例4：未选择任何模板
**测试步骤**:
1. 进入项目设备系统详情页面
2. 点击"添加子系统"按钮
3. 不选择任何模板
4. 直接点击"确认"按钮

**预期结果**:
- ✅ 显示警告："请选择要添加的子系统模板"
- ✅ 不提交任何数据
- ✅ 对话框不关闭

---

### 用例5：搜索和过滤功能
**测试步骤**:
1. 进入项目设备系统详情页面
2. 点击"添加子系统"按钮
3. 使用搜索功能查找特定模板
4. 验证"已添加"状态是否正确显示
5. 选择搜索结果中的模板
6. 点击"确认"按钮

**预期结果**:
- ✅ 搜索功能正常工作
- ✅ "已添加"状态正确显示
- ✅ 过滤逻辑正常工作
- ✅ 只提交未添加的模板

---

### 用例6：分页功能
**测试步骤**:
1. 进入项目设备系统详情页面
2. 点击"添加子系统"按钮
3. 切换到不同的页面
4. 验证每页的"已添加"状态是否正确
5. 从不同页面选择模板
6. 点击"确认"按钮

**预期结果**:
- ✅ 分页功能正常工作
- ✅ 每页的"已添加"状态正确显示
- ✅ 跨页选择功能正常
- ✅ 过滤逻辑正常工作

---

## 边界测试

### 边界1：大量模板
**测试数据**: 100个模板，其中50个已添加
**预期结果**: 过滤逻辑正常，性能良好

### 边界2：ID类型混合
**测试数据**: 模板ID包含字符串和数字类型
**预期结果**: 字符串比较逻辑正常工作

### 边界3：空数据
**测试数据**: 没有可选的模板
**预期结果**: 显示空状态提示

---

## 性能测试

### 测试指标
- 过滤100个模板的耗时 < 100ms
- UI响应时间 < 200ms
- 内存占用正常

---

## 回归测试

### 验证点
1. ✅ 原有的添加功能正常工作
2. ✅ 表格选择功能正常
3. ✅ 搜索功能正常
4. ✅ 分页功能正常
5. ✅ 对话框关闭功能正常
6. ✅ 数据刷新功能正常

---

## 测试结论

### 通过标准
- 所有测试用例通过
- 无语法错误
- 无运行时错误
- 用户体验良好

### 已知问题
- 无

### 改进建议
- 可以考虑添加批量操作的撤销功能
- 可以添加模板预览功能

