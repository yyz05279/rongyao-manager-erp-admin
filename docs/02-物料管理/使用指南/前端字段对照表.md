# 前端字段对照表

## 1. 字段映射关系

### 1.1 基础信息字段

| 前端字段名 | 后端字段名 | 类型 | 必填 | 说明 | 示例 |
|-----------|-----------|------|------|------|------|
| ~~itemName~~ | **materialName** | String | ✅ | 物料名称 | M6螺丝 |
| ~~itemCode~~ | **materialCode** | String | ❌ | 物料编码（后端自动生成） | WL20251112000001 |
| - | **materialType** | String | ✅ | 物料类型 | STANDARD_PARTS |
| specification | specification | String | ❌ | 规格型号 | 304不锈钢 |
| unit | unit | String | ❌ | 单位 | 袋、台 |
| manufacturer | manufacturer | String | ❌ | 制造商 | 标准件厂 |
| isFragile | isFragile | Boolean | ❌ | 是否易碎 | false |
| isHazardous | isHazardous | Boolean | ❌ | 是否危险品 | false |

> ⚠️ **重要变更**：
> - `itemName` → `materialName`
> - `itemCode` 不需要前端传入，后端自动生成
> - 新增必填字段：`materialType`

---

### 1.2 包装规格字段（新增）

| 前端字段名 | 后端字段名 | 类型 | 必填 | 说明 | 示例 |
|-----------|-----------|------|------|------|------|
| **packageQuantity** | packageQuantity | Integer | 条件必填* | 包装数量（每包数量） | 500 |
| **packageUnit** | packageUnit | String | 条件必填* | 包装单位 | 袋、箱、卷 |
| **baseUnit** | baseUnit | String | 条件必填* | 基础单位 | 颗、个、米 |
| **packageWeight** | packageWeight | Number | ❌ | 包装重量（单包重量，kg） | 2.5 |
| **packageVolume** | packageVolume | Number | ❌ | 包装体积（单包体积，m³） | 0.05 |
| **totalPackages** | totalPackages | Integer | ❌ | 总包装数 | 10 |

> *条件必填：如果填写了 `packageQuantity`，则 `packageUnit` 和 `baseUnit` 必填

---

### 1.3 进货信息字段（新增，自动计算）

| 前端字段名 | 后端字段名 | 类型 | 必填 | 说明 | 示例 |
|-----------|-----------|------|------|------|------|
| **totalQuantity** | totalQuantity | Number | ❌ | 总数量（自动计算，只读） | 5000 |
| totalWeight | totalWeight | Number | ❌ | 总重量（自动计算，只读） | 25 |
| totalVolume | totalVolume | Number | ❌ | 总体积（自动计算，只读） | 0.5 |

> ⚠️ **重要**：这些字段由后端自动计算，前端应设为只读

---

### 1.4 批次信息字段（新增）

| 前端字段名 | 后端字段名 | 类型 | 必填 | 说明 | 示例 |
|-----------|-----------|------|------|------|------|
| serialNumber | serialNumber | String | ❌ | 序列号/批次号 | SN20251112001 |
| productionDate | productionDate | String | ❌ | 生产日期（格式：yyyy-MM-dd） | 2025-11-01 |
| **expiryDate** | expiryDate | String | ❌ | 过期日期（格式：yyyy-MM-dd） | 2026-11-01 |

---

## 2. 前端请求示例

### 2.1 修改前（错误）

```json
{
  "itemCode": "MAT-1762231954495-3241",  // ❌ 不需要传入
  "itemName": "测试物料",                 // ❌ 字段名错误
  "specification": "测试规格",
  "unit": "袋",
  "unitWeight": 1.4,
  "totalWeight": 3,                      // ❌ 应由后端计算
  "unitVolume": 0.25,
  "totalVolume": 1,                      // ❌ 应由后端计算
  "manufacturer": "测试制造商",
  "serialNumber": "123123",
  "productionDate": "2025-11-05",
  "isFragile": 0,                        // ❌ 应为 Boolean
  "isHazardous": 0                       // ❌ 应为 Boolean
}
```

### 2.2 修改后（正确）- 有包装规格

```json
{
  "materialName": "M6螺丝",              // ✅ 修改字段名
  "materialType": "STANDARD_PARTS",      // ✅ 新增必填字段
  "specification": "304不锈钢",
  
  "packageQuantity": 500,                // ✅ 新增：包装数量
  "packageUnit": "袋",                   // ✅ 新增：包装单位
  "baseUnit": "颗",                      // ✅ 新增：基础单位
  "packageWeight": 2.5,                  // ✅ 新增：包装重量
  "packageVolume": 0.05,                 // ✅ 新增：包装体积
  "totalPackages": 10,                   // ✅ 新增：总包装数
  
  "serialNumber": "SN20251112001",
  "productionDate": "2025-11-01",
  
  "manufacturer": "标准件厂",
  "isFragile": false,                    // ✅ 修改为 Boolean
  "isHazardous": false                   // ✅ 修改为 Boolean
}
```

### 2.3 修改后（正确）- 无包装规格

```json
{
  "materialName": "变频器",
  "materialType": "ELECTRICAL",
  "specification": "380V 15KW",
  
  "unit": "台",
  "unitWeight": 45.5,
  "unitVolume": 0.2,
  "totalQuantity": 2,                    // ✅ 可以手动填写
  
  "manufacturer": "西门子",
  "serialNumber": "SN20251112002",
  "isFragile": false,
  "isHazardous": false
}
```

---

## 3. 前端响应示例

### 3.1 新增物料成功响应

```json
{
  "code": 200,
  "msg": "操作成功",
  "data": null
}
```

### 3.2 查询物料详情响应

```json
{
  "code": 200,
  "msg": "查询成功",
  "data": {
    "id": 1,
    "materialCode": "WL20251112000001",  // 后端自动生成
    "materialName": "M6螺丝",
    "materialType": "STANDARD_PARTS",
    "specification": "304不锈钢",
    
    "packageQuantity": 500,
    "packageUnit": "袋",
    "baseUnit": "颗",
    "packageWeight": 2.5,
    "packageVolume": 0.05,
    "totalPackages": 10,
    
    "totalQuantity": 5000,               // 后端自动计算
    "totalWeight": 25,                   // 后端自动计算
    "totalVolume": 0.5,                  // 后端自动计算
    
    "serialNumber": "SN20251112001",
    "productionDate": "2025-11-01",
    
    "manufacturer": "标准件厂",
    "isFragile": false,
    "isHazardous": false,
    
    "createTime": "2025-11-12 10:30:00",
    "updateTime": "2025-11-12 10:30:00"
  }
}
```

---

## 4. 前端表单设计

### 4.1 表单字段分组

```vue
<template>
  <el-form :model="form" :rules="rules" ref="formRef">
    
    <!-- 基础信息 -->
    <el-divider content-position="left">基础信息</el-divider>
    <el-form-item label="物料名称" prop="materialName">
      <el-input v-model="form.materialName" placeholder="请输入物料名称" />
    </el-form-item>
    
    <el-form-item label="物料类型" prop="materialType">
      <el-select v-model="form.materialType" placeholder="请选择物料类型">
        <el-option label="通用物料" value="GENERAL" />
        <el-option label="机械设备" value="MECHANICAL" />
        <el-option label="电气设备" value="ELECTRICAL" />
        <el-option label="管道材料" value="PIPELINE" />
        <el-option label="燃烧器" value="BURNER" />
        <el-option label="辅助材料" value="AUXILIARY" />
        <el-option label="标准件" value="STANDARD_PARTS" />
      </el-select>
    </el-form-item>
    
    <el-form-item label="规格型号" prop="specification">
      <el-input v-model="form.specification" placeholder="请输入规格型号" />
    </el-form-item>
    
    <!-- 包装规格（可选） -->
    <el-divider content-position="left">包装规格（可选）</el-divider>
    <el-form-item label="包装数量" prop="packageQuantity">
      <el-input-number 
        v-model="form.packageQuantity" 
        :min="1" 
        placeholder="每包/每箱的数量"
        @change="handlePackageChange" />
    </el-form-item>
    
    <el-form-item 
      label="包装单位" 
      prop="packageUnit"
      v-if="form.packageQuantity">
      <el-input v-model="form.packageUnit" placeholder="如：袋、箱、卷" />
    </el-form-item>
    
    <el-form-item 
      label="基础单位" 
      prop="baseUnit"
      v-if="form.packageQuantity">
      <el-input v-model="form.baseUnit" placeholder="如：颗、个、米" />
    </el-form-item>
    
    <el-form-item label="包装重量(kg)" prop="packageWeight">
      <el-input-number 
        v-model="form.packageWeight" 
        :min="0" 
        :precision="2"
        placeholder="单包重量" />
    </el-form-item>
    
    <el-form-item label="包装体积(m³)" prop="packageVolume">
      <el-input-number 
        v-model="form.packageVolume" 
        :min="0" 
        :precision="2"
        placeholder="单包体积" />
    </el-form-item>
    
    <!-- 进货信息（可选） -->
    <el-divider content-position="left">进货信息（可选）</el-divider>
    <el-form-item label="总包装数" prop="totalPackages">
      <el-input-number 
        v-model="form.totalPackages" 
        :min="1" 
        placeholder="进货包数"
        @change="handlePackageChange" />
    </el-form-item>
    
    <el-form-item label="总数量" prop="totalQuantity">
      <el-input-number 
        v-model="calculatedTotalQuantity" 
        :disabled="true"
        placeholder="自动计算" />
      <span class="form-tip">自动计算：包装数量 × 总包装数</span>
    </el-form-item>
    
    <el-form-item label="总重量(kg)" prop="totalWeight">
      <el-input-number 
        v-model="calculatedTotalWeight" 
        :disabled="true"
        placeholder="自动计算" />
      <span class="form-tip">自动计算：包装重量 × 总包装数</span>
    </el-form-item>
    
    <!-- 批次信息（可选） -->
    <el-divider content-position="left">批次信息（可选）</el-divider>
    <el-form-item label="序列号" prop="serialNumber">
      <el-input v-model="form.serialNumber" placeholder="请输入序列号/批次号" />
    </el-form-item>
    
    <el-form-item label="生产日期" prop="productionDate">
      <el-date-picker 
        v-model="form.productionDate" 
        type="date"
        value-format="YYYY-MM-DD"
        placeholder="选择生产日期" />
    </el-form-item>
    
    <el-form-item label="过期日期" prop="expiryDate">
      <el-date-picker 
        v-model="form.expiryDate" 
        type="date"
        value-format="YYYY-MM-DD"
        placeholder="选择过期日期" />
    </el-form-item>
    
    <!-- 其他信息 -->
    <el-divider content-position="left">其他信息</el-divider>
    <el-form-item label="制造商" prop="manufacturer">
      <el-input v-model="form.manufacturer" placeholder="请输入制造商" />
    </el-form-item>
    
    <el-form-item label="是否易碎" prop="isFragile">
      <el-switch v-model="form.isFragile" />
    </el-form-item>
    
    <el-form-item label="是否危险品" prop="isHazardous">
      <el-switch v-model="form.isHazardous" />
    </el-form-item>
    
  </el-form>
</template>

<script setup>
import { ref, computed } from 'vue'

const form = ref({
  materialName: '',
  materialType: '',
  specification: '',
  packageQuantity: null,
  packageUnit: '',
  baseUnit: '',
  packageWeight: null,
  packageVolume: null,
  totalPackages: null,
  serialNumber: '',
  productionDate: '',
  expiryDate: '',
  manufacturer: '',
  isFragile: false,
  isHazardous: false
})

// 自动计算总数量
const calculatedTotalQuantity = computed(() => {
  if (form.value.packageQuantity && form.value.totalPackages) {
    return form.value.packageQuantity * form.value.totalPackages
  }
  return null
})

// 自动计算总重量
const calculatedTotalWeight = computed(() => {
  if (form.value.packageWeight && form.value.totalPackages) {
    return form.value.packageWeight * form.value.totalPackages
  }
  return null
})

// 包装规格变化处理
const handlePackageChange = () => {
  // 触发计算
  console.log('总数量:', calculatedTotalQuantity.value)
  console.log('总重量:', calculatedTotalWeight.value)
}

// 表单验证规则
const rules = {
  materialName: [
    { required: true, message: '请输入物料名称', trigger: 'blur' }
  ],
  materialType: [
    { required: true, message: '请选择物料类型', trigger: 'change' }
  ],
  packageUnit: [
    { 
      required: true, 
      message: '填写了包装数量，必须填写包装单位', 
      trigger: 'blur',
      validator: (rule, value, callback) => {
        if (form.value.packageQuantity && !value) {
          callback(new Error('填写了包装数量，必须填写包装单位'))
        } else {
          callback()
        }
      }
    }
  ],
  baseUnit: [
    { 
      required: true, 
      message: '填写了包装数量，必须填写基础单位', 
      trigger: 'blur',
      validator: (rule, value, callback) => {
        if (form.value.packageQuantity && !value) {
          callback(new Error('填写了包装数量，必须填写基础单位'))
        } else {
          callback()
        }
      }
    }
  ]
}
</script>
```

---

## 5. 物料类型枚举

```typescript
export enum MaterialType {
  GENERAL = 'GENERAL',           // 通用物料
  MECHANICAL = 'MECHANICAL',     // 机械设备
  ELECTRICAL = 'ELECTRICAL',     // 电气设备
  PIPELINE = 'PIPELINE',         // 管道材料
  BURNER = 'BURNER',             // 燃烧器
  AUXILIARY = 'AUXILIARY',       // 辅助材料
  STANDARD_PARTS = 'STANDARD_PARTS' // 标准件
}

export const MaterialTypeOptions = [
  { label: '通用物料', value: 'GENERAL' },
  { label: '机械设备', value: 'MECHANICAL' },
  { label: '电气设备', value: 'ELECTRICAL' },
  { label: '管道材料', value: 'PIPELINE' },
  { label: '燃烧器', value: 'BURNER' },
  { label: '辅助材料', value: 'AUXILIARY' },
  { label: '标准件', value: 'STANDARD_PARTS' }
]
```

---

## 6. 前端修改清单

### 6.1 必须修改的字段

- [ ] `itemName` → `materialName`
- [ ] 移除 `itemCode`（后端自动生成）
- [ ] 新增 `materialType`（必填）
- [ ] `isFragile` 改为 Boolean 类型
- [ ] `isHazardous` 改为 Boolean 类型

### 6.2 新增的字段

- [ ] `packageQuantity`（包装数量）
- [ ] `packageUnit`（包装单位）
- [ ] `baseUnit`（基础单位）
- [ ] `packageWeight`（包装重量）
- [ ] `packageVolume`（包装体积）
- [ ] `totalPackages`（总包装数）
- [ ] `expiryDate`（过期日期）

### 6.3 只读字段（自动计算）

- [ ] `totalQuantity`（总数量）
- [ ] `totalWeight`（总重量）
- [ ] `totalVolume`（总体积）

---

**文档版本**：v1.0  
**创建时间**：2025-11-12  
**维护团队**：海棠开发团队

